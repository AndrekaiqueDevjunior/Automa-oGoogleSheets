<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Formulário de Proposta</title>
  <link rel="stylesheet" href="styles.css"> <!-- Conectando ao arquivo CSS -->
  <style>
    /* Estilização básica */
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }

    .form-row {
      display: flex;
      margin-bottom: 10px;
    }

    .col {
      flex: 1;
      margin-right: 10px;
    }

    .col:last-child {
      margin-right: 0;
      /* Remove margem do último item */
    }

    input,
    select,
    textarea {
      width: 100%;
      padding: 8px;
      box-sizing: border-box;
    }

    /* Estilização geral */
    body {
      font-family: 'Arial', sans-serif;
      background-color: #f4f4f4;
      margin: 0;
      padding: 20px;
    }

    /* Container do formulário */
    .container {
      background-color: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      padding: 20px;
      max-width: 800px;
      margin: auto;
    }

    /* Título do formulário */
    h1 {
      text-align: center;
      color: #333;
    }

    /* Estilo para fieldset */
    fieldset {
      border: 1px solid #ddd;
      border-radius: 8px;
      margin-bottom: 20px;
      padding: 20px;
    }

    /* Legenda do fieldset */
    legend {
      font-weight: bold;
      color: #555;
    }

    /* Estilo para grupos de formulário */
    .form-group {
      margin-bottom: 15px;
    }

    /* Estilo dos rótulos */
    label {
      font-weight: bold;
      color: #555;
    }

    /* Estilo dos inputs e selects */
    input,
    select,
    textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
      transition: border 0.3s;
    }

    /* Efeito ao focar nos inputs */
    input:focus,
    select:focus,
    textarea:focus {
      border-color: #007BFF;
      outline: none;
    }

    /* Estilo do botão de envio */
    .btn-submit {
      background-color: #007BFF;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
      transition: background 0.3s;
    }

    /* Efeito ao passar o mouse sobre o botão */
    .btn-submit:hover {
      background-color: #0056b3;
    }

    /* Estilo dos botões de adicionar item */
    .btn-add {
      background-color: #28a745;
      color: white;
      padding: 8px 16px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.3s;
    }

    /* Efeito ao passar o mouse sobre os botões de adicionar item */
    .btn-add:hover {
      background-color: #218838;
    }

    /* Estilo para grupos de itens */
    .item-group {
      background-color: #f9f9f9;
      border: 1px solid #ddd;
      border-radius: 4px;
      padding: 10px;
      margin-top: 10px;
    }
  </style>
</head>

<body>
  <div class="container">
    <h1>Formulário de Proposta</h1>
    <form id="propostaForm" onsubmit="enviarFormulario(event)">
      <fieldset>
        <legend>Dados do Cliente</legend>
        <div class="form-row">
          <div class="col">
            <label for="cliente">Cliente:</label>
            <input type="text" id="cliente" name="cliente" placeholder="Nome" required>
          </div>
          <div class="col">
            <label for="nomeFantasia">Nome Fantasia:</label>
            <input type="text" id="nomeFantasia" name="nomeFantasia" placeholder="Sobrenome" required>
          </div>
        </div>
        <div class="form-row">
          <div class="col">
            <label for="cnpj">CNPJ:</label>
            <input type="text" id="cnpj" name="cnpj" required>
          </div>
          <div class="col">
            <label for="comprador">Comprador:</label>
            <input type="text" id="comprador" name="comprador" required>
          </div>
        </div>
        <div class="form-row">
          <div class="col">
            <label for="emailComprador">Email do Comprador:</label>
            <input type="email" id="emailComprador" name="emailComprador" required>
          </div>
          <div class="col">
            <label for="telefone">Telefone:</label>
            <input type="tel" id="telefone" name="telefone" required>
          </div>
        </div>
        <div class="form-row">
          <div class="col">
            <label for="whatsapp">WhatsApp:</label>
            <input type="text" id="whatsapp" name="whatsapp" required>
          </div>
          <div class="col">
            <label for="endereco">Endereço:</label>
            <input type="text" id="endereco" name="endereco" required>
          </div>
        </div>
        <div class="form-row">
          <div class="col">
            <label for="numero">Número:</label>
            <input type="text" id="numero" name="numero" required>
          </div>
          <div class="col">
            <label for="complemento">Complemento:</label>
            <input type="text" id="complemento" name="complemento">
          </div>
        </div>
        <div class="form-row">
          <div class="col">
            <label for="bairro">Bairro:</label>
            <input type="text" id="bairro" name="bairro" required>
          </div>
          <div class="col">
            <label for="cidade">Cidade:</label>
            <input type="text" id="cidade" name="cidade" required>
          </div>
        </div>
        <div class="form-row">
          <div class="col">
            <label for="estado">Estado:</label>
            <input type="text" id="estado" name="estado" required>
          </div>
          <div class="col">
            <label for="telefoneGeral">Telefone Geral:</label>
            <input type="tel" id="telefoneGeral" name="telefoneGeral" required>
          </div>
        </div>
        <div class="form-row">
          <div class="col">
            <label for="emailGeral">Email Geral:</label>
            <input type="email" id="emailGeral" name="emailGeral">
          </div>
          <div class="col">
            <label for="ad1">Ad 1:</label>
            <input type="text" id="ad1" name="ad1">
          </div>
        </div>
        <div class="form-row">
          <div class="col">
            <label for="ad2">Ad 2:</label>
            <input type="text" id="ad2" name="ad2">
          </div>
        </div>
      </fieldset>
      <fieldset>
        <legend>Detalhes da Proposta</legend>
        <div class="form-row">
          <div class="col">
            <label for="dataProposta">Data:</label>
            <input type="date" id="dataProposta" name="dataProposta" required>
          </div>
          <div class="col">
            <label for="validadeProposta">Validade da Proposta:</label>
            <input type="date" id="validadeProposta" name="validadeProposta" required>
          </div>
        </div>
        <div class="form-row">
          <div class="col">
            <label for="condicaoPagamento">Condição de Pagamento:</label>
            <input type="text" id="condicaoPagamento" name="condicaoPagamento" required>
          </div>
          <div class="col">
            <label for="frete">Frete:</label>
            <input type="text" id="frete" name="frete">
          </div>
        </div>
        <div class="form-row">
          <div class="col">
            <label for="transportadora">Transportadora:</label>
            <input type="text" id="transportadora" name="transportadora">
          </div>
          <div class="col">
            <label for="valorTotalProposta">Valor Total da Proposta:</label>
            <input type="text" id="valorTotalProposta" name="valorTotalProposta" required>
          </div>
        </div>
        <div class="form-row">
          <div class="col">
            <label for="impostos">Impostos:</label>
            <input type="text" id="impostos" name="impostos">
          </div>
          <div class="col">
            <label for="frete2">Frete2:</label>
            <input type="text" id="frete2" name="frete2">
          </div>
        </div>
        <div class="form-row">
          <div class="col">
            <label for="notaPrazoEntrega">Nota sobre Prazo de Entrega:</label>
            <textarea id="notaPrazoEntrega" name="notaPrazoEntrega"></textarea>
          </div>
        </div>
        <div class="form-row">
          <div class="col">
            <label for="vendedor">Vendedor:</label>
            <input type="text" id="vendedor" name="vendedor" required>
          </div>
          <div class="col">
            <label for="emailVendedor">Email Vendedor:</label>
            <input type="email" id="emailVendedor" name="emailVendedor">
          </div>
        </div>
        <div class="form-row">
          <div class="col">
            <label for="telefoneVendedor">Telefone Vendedor:</label>
            <input type="tel" id="telefoneVendedor" name="telefoneVendedor">
          </div>
          <div class="col">
            <label for="whatsappVendedor">WhatsApp Vendedor:</label>
            <input type="text" id="whatsappVendedor" name="whatsappVendedor">
          </div>
        </div>
      </fieldset>
      <fieldset>
        <legend>Itens</legend>
        <div id="itensContainer"></div>
        <button type="button" class="btn-add" onclick="addItem()">Adicionar Item</button>
      </fieldset>
      <button type="submit" class="btn-submit">Enviar Proposta</button>
    </form>
  </div>

  <!-- Script para lidar com a adição de itens e envio de formulário -->
  <script>
    function addItem() {
            var container = document.getElementById('itensContainer');
            var itemIndex = container.children.length + 1;
            var itemHTML = `
                <div class="item-group">
                    <h4>Item ${itemIndex}</h4>
                    <div class="form-row">
                        <div class="col">
                            <label>Fabricante:</label> <input type="text" name="fabricante${itemIndex}" required>
                        </div>
                        <div class="col">
                            <label>Código:</label> <input type="text" name="codigo${itemIndex}" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="col">
                            <label>Descrição:</label> <input type="text" name="descricao${itemIndex}" required>
                        </div>
                        <div class="col">
                            <label>NCM:</label> <input type="text" name="ncm${itemIndex}" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="col">
                            <label>Quantidade:</label> <input type="number" name="quantidade${itemIndex}" required>
                        </div>
                        <div class="col">
                            <label>Preço Unitário:</label> <input type="number" step="0.01" name="precoUnitario${itemIndex}" required>
                        </div>
                    </div>
                </div>
            `;
            container.insertAdjacentHTML('beforeend', itemHTML);
        }

        function enviarFormulario(event) {
    event.preventDefault(); // Previne o comportamento padrão de envio de formulário
    
    var formData = new FormData(document.getElementById('propostaForm'));
    
    // Converte para um objeto JavaScript
    var dataObj = {};
    formData.forEach((value, key) => {
        dataObj[key] = value;
    });
    
    // Adiciona um campo adicional para contar os itens adicionados
    dataObj['numItens'] = document.getElementById('itensContainer').children.length;

    // Chama a função do Apps Script para enviar os dados
    google.script.run.withSuccessHandler(onSuccess).enviarProposta(dataObj);
}


        function onSuccess(response) {
            alert("Proposta enviada com sucesso!");
            document.getElementById('propostaForm').reset(); // Reseta o formulário após o envio
        }
  </script>
</body>

</html>